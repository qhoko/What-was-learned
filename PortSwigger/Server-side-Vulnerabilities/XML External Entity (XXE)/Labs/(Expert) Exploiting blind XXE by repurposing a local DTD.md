Exploiting blind XXE by repurposing a local DTD
The precending tecnique works fine with an external DTD, but it won't normally work with an internal DTD that is fully specified within the DOCTYPE element. This is because the technique involves using an XML parameter entity within the definition of another parameter entity. Per the XML specificationm this is permitted in external DTDs but not in internal DTTDs. (Some parses might tolerate it, but many do not.)

So what about blind XXE vulnerabilities when out-of-band interactions are blocked? You can't exfiltrate data via an out-of-band connection, and you can't load an external DTD from a remote server.

In this situation, it might still be possible to trigger error messages containing sensitive data, due to a loophole in the XML language specification. If a document's DTD uses a hybrid of internal and external DTD declarations, the the internal DTD can redefine entities that are declared in the external DTD. When this happens, the restriction on using an XML parameter entitiy within the definition of another parameter entity is relaxed.
